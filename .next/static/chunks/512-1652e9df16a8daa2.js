"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[512],{5936:function(e,t,s){s.d(t,{Z:function(){return r}});var i=s(5893);s(7294);var l=s(1649);function r(){return(0,i.jsxs)("button",{className:"bg-intermediate bg-opacity-70 hover:bg-opacity-100 transition-all py-2 px-4 rounded-md flex flex-row justify-center items-center drop-shadow-2xl",children:[(0,i.jsx)(l.gyF,{size:26})," ",(0,i.jsx)("p",{children:"Create Ticket"})]})}},1026:function(e,t,s){s.d(t,{Z:function(){return k}});var i=s(7568),l=s(603),r=s(655),a=s(5893),n=s(7294),c=s(5636),o=s(3299),d=s(2453),u=s(6477),m=s(7527),f=s(8033),h=s(5788),x=s(3750),j=s(9583),p=s(8193),w=s(2831),g=s(442),y=s(3588),b=s(381),v=s.n(b),N=s(3838);function k(e){var t=e.teamsData,s=e.setIsCreateTicket,b=function(e){var t={title:e.title,description:e.description,deadline:e.deadline,userId:Z.user.id,teamId:e.team,employeeId:e.employee,ticketStatusId:e.ticket_status,ticketPiorityId:e.ticket_piority,resource:""};Y(!0),U?(0,c.G1)(U).then(function(e){e.error?(d.ZP.error("Error while uploading resource for ticket!"),Y(!1)):(t.resource=e.data.newName,(0,c.HO)(t).then(function(e){e.error?(d.ZP.error("Error while Creating and assigning a ticket to an employee!"),Y(!1)):(Y(!1),d.ZP.success("Created and assigned a ticket to an employee!"),s(!1))}))}).catch(function(e){console.log(e),Y(!1)}):(0,c.HO)(t).then(function(e){e.error?(d.ZP.error("Error while Creating and assigning a ticket to an employee!"),Y(!1)):(Y(!1),d.ZP.success("Created and assigned a ticket to an employee!"),s(!1))})},k=(0,o.useSession)(),Z=k.data;k.status;var T=(0,n.useState)(void 0===t?[]:t),S=T[0],P=T[1],C=(0,n.useState)([]),E=C[0],I=C[1],_=(0,n.useState)([]),D=_[0],z=_[1],q=(0,n.useState)([]),A=q[0],F=q[1],M=(0,n.useState)(!0),O=M[0],Y=M[1],H=(0,n.useState)(!1);H[0],H[1];var R=(0,n.useState)(!1),L=R[0],Q=R[1],B=(0,n.useState)(null),U=B[0],V=B[1],X=w.Z.TextArea,G=(0,l.Z)(g.Z.useForm(),1)[0];function W(){return(W=(0,i.Z)(function(){return(0,r.__generator)(this,function(e){switch(e.label){case 0:if(0!=S.length)return[3,2];return Y(!0),[4,(0,c.qX)().then(function(e){e.error?d.ZP.error("Error while getting all teams!"):(P(e.data),Y(!1))})];case 1:e.sent(),e.label=2;case 2:if(0!=E.length)return[3,4];return Y(!0),[4,(0,c.fN)().then(function(e){e.error?d.ZP.error("Error while getting all employees!"):(I(e.data),Y(!1))})];case 3:e.sent(),e.label=4;case 4:if(0!=D.length)return[3,6];return Y(!0),[4,(0,c.L)().then(function(e){e.error?d.ZP.error("Error while getting tickets status!"):(z(e.data.data),Y(!1))})];case 5:e.sent(),e.label=6;case 6:if(0!=A.length)return[3,8];return Y(!0),[4,(0,c.Xd)().then(function(e){e.error?d.ZP.error("Error while getting tickets piority!"):(F(e.data.data),Y(!1))})];case 7:e.sent(),e.label=8;case 8:return[2]}})})).apply(this,arguments)}(0,n.useEffect)(function(){!function(){return W.apply(this,arguments)}()},[]);var J=(0,n.useRef)(null),K=function(e){J.current.click()},$=function(e){console.log(e.target.files[0]),V(e.target.files[0])};return(0,a.jsx)(N.E.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{duration:.15,ease:"easeIn"},className:"flex flex-col items-center z-10 w-full",children:(0,a.jsx)("div",{className:"create-ticket-model mb-4",children:(0,a.jsxs)("div",{className:"bg-gray-900 p-4 rounded-md drop-shadow-lg flex flex-col justify-between items-center w-[22rem] sm:w-[35rem]",children:[(0,a.jsxs)("header",{className:"flex flex-row justify-between items-center w-full",children:[(0,a.jsxs)("div",{className:"flex justify-center items-center",children:[(0,a.jsx)(x.eHD,{size:24}),(0,a.jsx)("h1",{className:"ml-2 font-semibold text-lg",children:"Create Ticket"})]}),(0,a.jsxs)("div",{className:"flex flex-row justify-center items-center",children:[(0,a.jsx)(u.Z,{placement:"top",title:"Add resource",mouseEnterDelay:.05,children:(0,a.jsxs)("div",{className:"bg-white bg-opacity-10 hover:bg-opacity-20 transition-all cursor-pointer p-2 rounded-full mr-3",onClick:function(){return K()},children:[(0,a.jsx)(p.O1u,{size:18}),(0,a.jsx)("input",{type:"file",className:"hidden",multiple:!1,placeholder:"Choose file",ref:J,onChange:$})]})}),(0,a.jsx)("button",{className:"cancel-btn opacity-60 hover:opacity-100",onClick:function(){return s(!1)},children:(0,a.jsx)(h.ySC,{size:24})})]})]}),(0,a.jsx)("div",{className:"my-4 w-full",children:(0,a.jsx)(y.Z,{color:"bg-gray-800",width:"w-full",opacity:"opacity-1"})}),(0,a.jsxs)(g.Z,{form:G,layout:"vertical",name:"create project - part 1",onFinish:b,style:{width:"100%"},scrollToFirstError:!0,disabled:O,children:[(0,a.jsx)(g.Z.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Ticket title is required!"},{min:5,message:"Ticket title must be atleast 5 characters long!"},{whitespace:!0,message:"Ticket title must be atleast 1 non-whitespace character!"},],children:(0,a.jsx)(w.Z,{placeholder:"Enter a ticket title"})}),(0,a.jsx)(g.Z.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Description title is required!"},{min:5,message:"Ticket Description must be atleast 5 characters long!"},{whitespace:!0,message:"Ticket Description must be atleast 1 non-whitespace character!"},],children:(0,a.jsx)(X,{rows:4,placeholder:"Enter a description"})}),(0,a.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,a.jsx)(g.Z.Item,{name:"team",label:"Team",rules:[{required:!0,message:"Please select a team!"},],className:"w-full",children:(0,a.jsx)(m.Z,{placeholder:"Select team",onChange:function(e){console.log(e),Q(e)},children:S.map(function(e){return(0,a.jsx)(m.Z.Option,{value:e.id,children:e.team_name},e.id)})})}),(0,a.jsx)(g.Z.Item,{name:"employee",label:"Assignee Employee",rules:[{required:!0,message:"Please select a Assignee Employee!"},],className:"w-full ml-2",children:(0,a.jsx)(m.Z,{disabled:!L,placeholder:"Select employee",children:E.map(function(e){if(e.UserTeams.find(function(e){return e.team_id==L}))return(0,a.jsxs)(m.Z.Option,{value:e.id,children:[e.first_name," ",e.last_name]},e.id)})})})]}),(0,a.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,a.jsx)(g.Z.Item,{name:"ticket_status",label:"Ticket status",rules:[{required:!0,message:"Please select a ticket status!"},],className:"w-full",children:(0,a.jsx)(m.Z,{placeholder:"Select a status",children:D.map(function(e){var t="Todo"==e.title?"green":"In-progress"==e.title?"orange":"Done"==e.title?"purple":"Resolved"==e.title?"blue":"Tested but not resolved"==e.title?"red":"white";return(0,a.jsx)(m.Z.Option,{value:e.id,children:(0,a.jsxs)("div",{className:"flex justify-start items-center -mb-7",children:[(0,a.jsx)("div",{className:"h-3 w-3 rounded-full opacity-30 mr-2",style:{backgroundColor:t}}),e.title]})},e.id)})})}),(0,a.jsx)(g.Z.Item,{name:"ticket_piority",label:"Ticket piority",rules:[{required:!0,message:"Please give a ticket piority!"},],className:"w-full ml-2",children:(0,a.jsx)(m.Z,{placeholder:"Select a piority",children:A.map(function(e){var t="Urgent"==e.title?"red":"High"==e.title?"yellow":"Normal"==e.title?"green":"white";return(0,a.jsx)(m.Z.Option,{value:e.id,children:(0,a.jsxs)("div",{className:"flex justify-start items-center -mb-7",children:[(0,a.jsx)(j.wQ2,{color:t,className:"mr-2"}),e.title]})},e.id)})})})]}),(0,a.jsx)(g.Z.Item,{name:"deadline",label:"Ticket Deadline",rules:[{required:!0,message:"Ticket Deadline is required!"},],children:(0,a.jsx)(f.Z,{className:"w-full",disabledDate:function(e){return v()().add(-1,"days")>=e||v()().add(1,"month")<=e}})}),(0,a.jsx)("button",{className:"bg-primary h-12 p-2 rounded-md flex flex-row justify-center items-center w-full text-lg font-semibold mt-4 disabled:opacity-50",disabled:O,children:O?(0,a.jsxs)("svg",{class:"animate-spin -ml-1 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),(0,a.jsx)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,a.jsx)("p",{children:"Create"})})]})]})})})}},7153:function(e,t,s){s.d(t,{Z:function(){return y}});var i=s(5893),l=s(629),r=s(1687),a=s(7527),n=s(5737),c=s(2453),o=s(7294);s(3588);var d=s(5636),u=s(7516),m=s(381),f=s.n(m),h=s(9583),x=s(6893),j=s(9352),p=s(3750),w=s(3802),g=s(3299);function y(e){var t,s=function(){e.isTicketInfo.id&&(k(!0),(0,d.Q4)(e.isTicketInfo.id).then(function(e){e.error?(k(!1),c.ZP.error("Some error occoured while fetching project employees!")):(E(e.data.data),k(!1))}),(0,d.L)().then(function(e){e.error?c.ZP.error("Some error occoured while fetching project employees!"):D(e.data.data)}))},m=function(e){(0,d.AF)(C.id,e).then(function(e){e.error?c.ZP.error("Error while changing status of ticket!"):(c.ZP.success("Ticket status has been changed!"),s())})},y=function(){k(!0),(0,d.cc)(C.id,q.user.id).then(function(t){t.error?(c.ZP.error("Error while changing status of ticket!"),k(!1)):(c.ZP.success("Ticket status has been deleted!"),e.setIsTicketInfo({id:null}))})},b=function(e){S(!0),(0,d.xn)(e).then(function(e){e.data?(c.ZP.success("Resource download started!"),S(!1)):(c.ZP.error("Error while downloading resouce!"),S(!1))})},v=(0,o.useState)(!0),N=v[0],k=v[1],Z=(0,o.useState)(!1),T=Z[0],S=Z[1],P=(0,o.useState)(null),C=P[0],E=P[1],I=(0,o.useState)([]),_=I[0],D=I[1],z=(0,g.useSession)(),q=z.data;z.status;var A=(0,o.useState)([0,0]),F=A[0],M=A[1];return(0,o.useEffect)(function(){var e=function(){M([window.innerWidth,window.innerHeight])};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}},[]),(0,o.useEffect)(function(){s()},[e.isTicketInfo.id]),(0,i.jsx)(l.Z,{title:"Ticket",onClose:function(){return e.setIsTicketInfo({id:null})},open:e.isTicketInfo.id,bodyStyle:{paddingBottom:80},width:F[0]>1100?"70%":"100%",children:N||!C?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.Z,{active:!0}),(0,i.jsx)("div",{className:"mt-4",children:(0,i.jsx)(r.Z,{active:!0})}),(0,i.jsx)("div",{className:"mt-56",children:(0,i.jsx)(r.Z,{active:!0})})]}):(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"tickets-info",children:[(0,i.jsx)("header",{className:"flex flex-row justify-between",children:(0,i.jsxs)("div",{className:"flex flex-col w-full",children:[(0,i.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center w-full",children:[(0,i.jsxs)("div",{className:"flex flex-row items-center opacity-75",children:[(0,i.jsx)("div",{className:"w-6",children:(0,i.jsx)(u.ybL,{size:28})}),(0,i.jsx)("h1",{className:"text-xl md:text-3xl font-semibold ml-2",children:C.title})]}),(0,i.jsx)("div",{className:"md:m-0 m-4",children:(0,i.jsx)(a.Z,{defaultValue:function(){var e=_.find(function(e){return e.id==C.ticketStatusId});return null==e?void 0:e.title},style:{width:200},onChange:function(e){return m(e)},children:_.map(function(e){return(0,i.jsx)(a.Z.Option,{value:e.id,children:e.title},e.id)})})})]}),(0,i.jsxs)("div",{className:"text-lg flex flex-row items-center",children:[(t=C.TicketStatus.title,(0,i.jsx)("div",{className:"rounded-full text-lg bg-opacity-25",children:(0,i.jsx)("h1",{style:{color:"orange"},children:t})})),(0,i.jsxs)("p",{className:"ml-2",children:[C.user.employee.first_name," ",C.user.employee.last_name]}),(0,i.jsxs)("p",{className:"opacity-50 ml-2",children:["Opened on"," ",f()(C.createdAt).format("MMMM Do YYYY")]})]})]})}),(0,i.jsx)("div",{className:"tabdevider h-[1.5px] my-4 bg-opacity-10 bg-white w-full rounded-lg"}),(0,i.jsx)("div",{className:"border-2 border-gray-600 rounded-lg p-4 h-full",children:(0,i.jsxs)("div",{className:"h-[20rem]",children:[(0,i.jsx)("p",{className:"italic mb-4 font-bold opacity-30",children:"Description"}),(0,i.jsx)("div",{children:C.description})]})}),(0,i.jsx)("div",{className:"tabdevider h-[1.5px] my-4 bg-opacity-10 bg-white w-full rounded-lg"}),(0,i.jsxs)("div",{className:"flex flex-col md:flex-row justify-between w-full h-full",children:[(0,i.jsxs)("div",{className:"flex flex-col w-full md:w-1/2",children:[(0,i.jsxs)("div",{className:"flex justify-between w-full text-base mb-4",children:[(0,i.jsx)("h1",{className:"opacity-50",children:"Assigned to"}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(j.RrS,{size:22,className:"mr-2"}),(0,i.jsxs)("h1",{className:"",children:[C.employee.first_name," ",C.employee.last_name]})]})]}),(0,i.jsxs)("div",{className:"flex justify-between w-full text-base mb-4",children:[(0,i.jsx)("h1",{className:"opacity-50",children:"Project"}),(0,i.jsx)("h1",{className:"",children:C.project.project_name})]}),(0,i.jsxs)("div",{className:"flex justify-between w-full text-base mb-4",children:[(0,i.jsx)("h1",{className:"opacity-50",children:"Team"}),(0,i.jsx)("h1",{className:"",children:C.team.team_name})]}),(0,i.jsxs)("div",{className:"flex justify-between w-full text-base mb-4",children:[(0,i.jsx)("h1",{className:"opacity-50",children:"Deadline"}),(0,i.jsx)("h1",{className:"",children:f()(C.deadline).format("MMMM Do YYYY")})]}),(0,i.jsxs)("div",{className:"flex justify-between w-full text-base mb-4",children:[(0,i.jsx)("h1",{className:"opacity-50",children:"Piority"}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(h.wQ2,{className:"mr-2"}),(0,i.jsx)("h1",{className:"",children:C.TicketPiority.title})]})]})]}),(0,i.jsx)("div",{className:"tabdevider w-[1.5px] md:flex hidden h-[10rem] mx-4 bg-opacity-10 bg-white rounded-lg"}),(0,i.jsxs)("div",{className:"w-full md:w-1/2 flex flex-col",children:[C.Resource[0].url?(0,i.jsxs)("button",{className:"py-2 mb-4 bg-green-600 bg-opacity-20 hover:bg-opacity-30 transition-all w-full rounded-lg flex flex-row justify-center items-center disabled:opacity-50",onClick:function(){return b(C.Resource[0].url)},disabled:T,children:[(0,i.jsx)(p.eHD,{color:"green",size:20}),(0,i.jsx)("p",{className:"text-green-600 tex-xl font-bold ml-2",children:"Downlaod Resource"})]}):(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"py-2 mb-4 bg-white bg-opacity-10 transition-all w-full rounded-lg flex flex-row justify-center items-center disabled:opacity-50",children:[(0,i.jsx)(p.eHD,{color:"white",size:20}),(0,i.jsx)("p",{className:"text-white-600 tex-xl font-bold ml-2",children:"No resource added!"})]})}),(0,i.jsx)(w.Z,{grantPermissionFor:"manage_tickets",children:(0,i.jsx)(n.Z,{title:"Are you sure you want to delete this ticket?",onConfirm:function(){y()},okText:"Confirm",cancelText:"No",placement:"top",children:(0,i.jsxs)("button",{className:"py-2 bg-red-600 bg-opacity-20 hover:bg-opacity-30 transition-all w-full rounded-lg flex flex-row justify-center items-center",children:[(0,i.jsx)(x.Ybf,{color:"red",size:20}),(0,i.jsx)("p",{className:"text-red-600 tex-xl font-bold ml-2",children:"Delete Ticket"})]})})})]})]})]})})})}}}]);