"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[544],{5936:function(e,t,s){s.d(t,{Z:function(){return r}});var i=s(5893);s(7294);var l=s(1649);function r(){return(0,i.jsxs)("button",{className:"bg-intermediate bg-opacity-70 hover:bg-opacity-100 transition-all py-2 px-4 rounded-md flex flex-row justify-center items-center drop-shadow-2xl",children:[(0,i.jsx)(l.gyF,{size:26})," ",(0,i.jsx)("p",{children:"Create Ticket"})]})}},1026:function(e,t,s){s.d(t,{Z:function(){return N}});var i=s(7568),l=s(603),r=s(655),n=s(5893),a=s(7294),c=s(5636),o=s(3299),d=s(2453),u=s(6477),m=s(7527),f=s(8033),x=s(5788),h=s(3750),j=s(9583),p=s(8193),b=s(2831),w=s(442),g=s(3588),y=s(381),k=s.n(y),v=s(3838);function N(e){var t=e.teamsData,s=e.setIsCreateTicket,y=function(e){var t={title:e.title,description:e.description,deadline:e.deadline,userId:Z.user.id,teamId:e.team,employeeId:e.employee,ticketStatusId:e.ticket_status,ticketPiorityId:e.ticket_piority,resource:""};M(!0),Q?(0,c.G1)(Q).then(function(e){e.error?(d.ZP.error("Error while uploading resource for ticket!"),M(!1)):(t.resource=e.data.newName,(0,c.HO)(t).then(function(e){e.error?(d.ZP.error("Error while Creating and assigning a ticket to an employee!"),M(!1)):(M(!1),d.ZP.success("Created and assigned a ticket to an employee!"),s(!1))}))}).catch(function(e){console.log(e),M(!1)}):(0,c.HO)(t).then(function(e){e.error?(d.ZP.error("Error while Creating and assigning a ticket to an employee!"),M(!1)):(M(!1),d.ZP.success("Created and assigned a ticket to an employee!"),s(!1))})},N=(0,o.useSession)(),Z=N.data;N.status;var S=(0,a.useState)(void 0===t?[]:t),I=S[0],C=S[1],T=(0,a.useState)([]),P=T[0],E=T[1],z=(0,a.useState)([]),D=z[0],_=z[1],W=(0,a.useState)([]),F=W[0],q=W[1],A=(0,a.useState)(!0),H=A[0],M=A[1],O=(0,a.useState)(!1);O[0],O[1];var Y=(0,a.useState)(!1),R=Y[0],L=Y[1],B=(0,a.useState)(null),Q=B[0],U=B[1],V=b.Z.TextArea,X=(0,l.Z)(w.Z.useForm(),1)[0];function G(){return(G=(0,i.Z)(function(){return(0,r.__generator)(this,function(e){switch(e.label){case 0:if(0!=I.length)return[3,2];return M(!0),[4,(0,c.qX)().then(function(e){e.error?d.ZP.error("Error while getting all teams!"):(C(e.data),M(!1))})];case 1:e.sent(),e.label=2;case 2:if(0!=P.length)return[3,4];return M(!0),[4,(0,c.fN)().then(function(e){e.error?d.ZP.error("Error while getting all employees!"):(E(e.data),M(!1))})];case 3:e.sent(),e.label=4;case 4:if(0!=D.length)return[3,6];return M(!0),[4,(0,c.L)().then(function(e){e.error?d.ZP.error("Error while getting tickets status!"):(_(e.data.data),M(!1))})];case 5:e.sent(),e.label=6;case 6:if(0!=F.length)return[3,8];return M(!0),[4,(0,c.Xd)().then(function(e){e.error?d.ZP.error("Error while getting tickets piority!"):(q(e.data.data),M(!1))})];case 7:e.sent(),e.label=8;case 8:return[2]}})})).apply(this,arguments)}(0,a.useEffect)(function(){!function(){return G.apply(this,arguments)}()},[]);var J=(0,a.useRef)(null),$=function(e){J.current.click()},K=function(e){console.log(e.target.files[0]),U(e.target.files[0])};return(0,n.jsx)(v.E.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{duration:.15,ease:"easeIn"},className:"flex flex-col items-center z-10 w-full",children:(0,n.jsx)("div",{className:"create-ticket-model mb-4",children:(0,n.jsxs)("div",{className:"bg-gray-900 p-4 rounded-md drop-shadow-lg flex flex-col justify-between items-center w-[22rem] sm:w-[35rem]",children:[(0,n.jsxs)("header",{className:"flex flex-row justify-between items-center w-full",children:[(0,n.jsxs)("div",{className:"flex justify-center items-center",children:[(0,n.jsx)(h.eHD,{size:24}),(0,n.jsx)("h1",{className:"ml-2 font-semibold text-lg",children:"Create Ticket"})]}),(0,n.jsxs)("div",{className:"flex flex-row justify-center items-center",children:[(0,n.jsx)(u.Z,{placement:"top",title:"Add resource",mouseEnterDelay:.05,children:(0,n.jsxs)("div",{className:"bg-white bg-opacity-10 hover:bg-opacity-20 transition-all cursor-pointer p-2 rounded-full mr-3",onClick:function(){return $()},children:[(0,n.jsx)(p.O1u,{size:18}),(0,n.jsx)("input",{type:"file",className:"hidden",multiple:!1,placeholder:"Choose file",ref:J,onChange:K})]})}),(0,n.jsx)("button",{className:"cancel-btn opacity-60 hover:opacity-100",onClick:function(){return s(!1)},children:(0,n.jsx)(x.ySC,{size:24})})]})]}),(0,n.jsx)("div",{className:"my-4 w-full",children:(0,n.jsx)(g.Z,{color:"bg-gray-800",width:"w-full",opacity:"opacity-1"})}),(0,n.jsxs)(w.Z,{form:X,layout:"vertical",name:"create project - part 1",onFinish:y,style:{width:"100%"},scrollToFirstError:!0,disabled:H,children:[(0,n.jsx)(w.Z.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Ticket title is required!"},{min:5,message:"Ticket title must be atleast 5 characters long!"},{whitespace:!0,message:"Ticket title must be atleast 1 non-whitespace character!"},],children:(0,n.jsx)(b.Z,{placeholder:"Enter a ticket title"})}),(0,n.jsx)(w.Z.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Description title is required!"},{min:5,message:"Ticket Description must be atleast 5 characters long!"},{whitespace:!0,message:"Ticket Description must be atleast 1 non-whitespace character!"},],children:(0,n.jsx)(V,{rows:4,placeholder:"Enter a description"})}),(0,n.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,n.jsx)(w.Z.Item,{name:"team",label:"Team",rules:[{required:!0,message:"Please select a team!"},],className:"w-full",children:(0,n.jsx)(m.Z,{placeholder:"Select team",onChange:function(e){console.log(e),L(e)},children:I.map(function(e){return(0,n.jsx)(m.Z.Option,{value:e.id,children:e.team_name},e.id)})})}),(0,n.jsx)(w.Z.Item,{name:"employee",label:"Assignee Employee",rules:[{required:!0,message:"Please select a Assignee Employee!"},],className:"w-full ml-2",children:(0,n.jsx)(m.Z,{disabled:!R,placeholder:"Select employee",children:P.map(function(e){if(e.UserTeams.find(function(e){return e.team_id==R}))return(0,n.jsxs)(m.Z.Option,{value:e.id,children:[e.first_name," ",e.last_name]},e.id)})})})]}),(0,n.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,n.jsx)(w.Z.Item,{name:"ticket_status",label:"Ticket status",rules:[{required:!0,message:"Please select a ticket status!"},],className:"w-full",children:(0,n.jsx)(m.Z,{placeholder:"Select a status",children:D.map(function(e){var t="Todo"==e.title?"green":"In-progress"==e.title?"orange":"Done"==e.title?"purple":"Resolved"==e.title?"blue":"Tested but not resolved"==e.title?"red":"white";return(0,n.jsx)(m.Z.Option,{value:e.id,children:(0,n.jsxs)("div",{className:"flex justify-start items-center -mb-7",children:[(0,n.jsx)("div",{className:"h-3 w-3 rounded-full opacity-30 mr-2",style:{backgroundColor:t}}),e.title]})},e.id)})})}),(0,n.jsx)(w.Z.Item,{name:"ticket_piority",label:"Ticket piority",rules:[{required:!0,message:"Please give a ticket piority!"},],className:"w-full ml-2",children:(0,n.jsx)(m.Z,{placeholder:"Select a piority",children:F.map(function(e){var t="Urgent"==e.title?"red":"High"==e.title?"yellow":"Normal"==e.title?"green":"white";return(0,n.jsx)(m.Z.Option,{value:e.id,children:(0,n.jsxs)("div",{className:"flex justify-start items-center -mb-7",children:[(0,n.jsx)(j.wQ2,{color:t,className:"mr-2"}),e.title]})},e.id)})})})]}),(0,n.jsx)(w.Z.Item,{name:"deadline",label:"Ticket Deadline",rules:[{required:!0,message:"Ticket Deadline is required!"},],children:(0,n.jsx)(f.Z,{className:"w-full",disabledDate:function(e){return k()().add(-1,"days")>=e||k()().add(1,"month")<=e}})}),(0,n.jsx)("button",{className:"bg-primary h-12 p-2 rounded-md flex flex-row justify-center items-center w-full text-lg font-semibold mt-4 disabled:opacity-50",disabled:H,children:H?(0,n.jsxs)("svg",{class:"animate-spin -ml-1 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),(0,n.jsx)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,n.jsx)("p",{children:"Create"})})]})]})})})}},8960:function(e,t,s){s.d(t,{Z:function(){return v}});var i=s(5893),l=s(5265),r=s(1687),n=s(7527),a=s(6738),c=s(2453),o=s(7294);s(3588);var d=s(5636),u=s(7516),m=s(381),f=s.n(m),x=s(9583),h=s(6893),j=s(9352),p=s(3750),b=s(7106),w=s(3802),g=s(3299);function y(e){var t=function(e){(0,d.Nw)(e).then(function(e){e.data?c.ZP.success("Work submission download started!"):c.ZP.error("Error while downloading work submission!")})};return(0,i.jsx)(l.Z,{title:"Work Submission",onClose:function(){return e.setIsWorkSubmission(!1)},open:e.isWorkSubmission,bodyStyle:{paddingBottom:80},children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("h1",{className:"text-lg font-semibold",children:"Previous submissions"}),(0,i.jsx)("p",{className:"text-sm",children:"Following are all the work submitted against ticket"}),e.work.map(function(e,s){return(0,i.jsxs)("div",{className:"p-4 mt-2 border-[1.5px] border-gray-500 bg-gray-800 rounded-md flex flex-col",children:[(0,i.jsxs)("p",{children:["Submission Id: ",s+1]}),(0,i.jsxs)("button",{className:"bg-gray-400 rounded-sm py-2 mt-2 flex justify-center",onClick:function(){return t(e.url)},children:[(0,i.jsx)(u.JfT,{size:20,color:"black"}),(0,i.jsx)("p",{className:"text-black ml-2 font-semibold",children:"Download Submitted Work"})]})]},s)})]})})}function k(e){var t=(0,o.useState)(null),s=t[0],r=t[1],n=(0,o.useState)(!1),a=n[0],m=n[1],f=(0,o.useRef)(null),x=function(e){f.current.click()},h=function(e){console.log(e.target.files[0]),r(e.target.files[0])};return(0,o.useEffect)(function(){s&&(m(!0),(0,d.FD)(s).then(function(t){if(console.log(t),t.error)c.ZP.error("Error while uploading work"),m(!1);else{var s={work:t.data.newName,ticketId:e.ticketId};(0,d.gf)(s).then(function(t){console.log(t),t.data?(m(!1),c.ZP.success("Work has been submitted!"),e.setIsSubmitWork(!1)):(c.ZP.error("Error while submitting work"),m(!1))})}}).catch(function(e){console.log(e),m(!1)}))},[s]),(0,i.jsx)(l.Z,{title:"Submit Work",onClose:function(){return e.setIsSubmitWork(!1)},open:e.isSubmitWork,bodyStyle:{paddingBottom:80},children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsxs)("h1",{className:"text-sm",children:["Please verify your work before submission. After uploading your submission can not be changed. You can only have multiple revisions of your work. ",(0,i.jsx)("br",{})," Note: If you have multiple files to submit kindly zip it in to a single file."]}),(0,i.jsx)("button",{className:"bg-gray-400 rounded-sm py-2 mt-4 flex justify-center",onClick:function(){return x()},disabled:a,children:a?(0,i.jsxs)("svg",{class:"animate-spin -ml-1 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,i.jsx)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),(0,i.jsx)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,i.jsxs)(i.Fragment,{children:[" ",(0,i.jsx)(u.UL7,{size:20,color:"black"}),(0,i.jsx)("p",{className:"text-black ml-2 font-semibold",children:"Submit Work"})]})}),(0,i.jsx)("input",{type:"file",className:"hidden",multiple:!1,placeholder:"Choose file",ref:f,onChange:h})]})})}function v(e){var t,s=function(){e.isTicketInfo.id&&(I(!0),(0,d.Q4)(e.isTicketInfo.id).then(function(e){e.error?(I(!1),c.ZP.error("Some error occoured while fetching project employees!")):(D(e.data.data),I(!1))}),(0,d.L)().then(function(e){e.error?c.ZP.error("Some error occoured while fetching project employees!"):F(e.data.data)}))},m=function(e){(0,d.AF)(z.id,e).then(function(e){e.error?c.ZP.error("Error while changing status of ticket!"):(c.ZP.success("Ticket status has been changed!"),s())})},v=function(){I(!0),(0,d.cc)(z.id,L.user.id).then(function(t){t.error?(c.ZP.error("Error while changing status of ticket!"),I(!1)):(c.ZP.success("Ticket status has been deleted!"),e.setIsTicketInfo({id:null}))})},N=function(e){P(!0),(0,d.xn)(e).then(function(e){e.data?(c.ZP.success("Resource download started!"),P(!1)):(c.ZP.error("Error while downloading resouce!"),P(!1))})},Z=(0,o.useState)(!0),S=Z[0],I=Z[1],C=(0,o.useState)(!1),T=C[0],P=C[1],E=(0,o.useState)(null),z=E[0],D=E[1],_=(0,o.useState)([]),W=_[0],F=_[1],q=(0,o.useState)(!1),A=q[0],H=q[1],M=(0,o.useState)(!1),O=M[0],Y=M[1],R=(0,g.useSession)(),L=R.data;R.status;var B=(0,o.useState)([window.innerWidth,window.innerHeight,]),Q=B[0],U=B[1];return(0,o.useEffect)(function(){var e=function(){U([window.innerWidth,window.innerHeight])};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}},[]),(0,o.useEffect)(function(){s()},[e.isTicketInfo.id]),(0,i.jsx)(l.Z,{title:"Ticket",onClose:function(){return e.setIsTicketInfo({id:null})},open:e.isTicketInfo.id,bodyStyle:{paddingBottom:80},width:Q[0]>1100?"70%":"100%",children:S||!z?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.Z,{active:!0}),(0,i.jsx)("div",{className:"mt-4",children:(0,i.jsx)(r.Z,{active:!0})}),(0,i.jsx)("div",{className:"mt-56",children:(0,i.jsx)(r.Z,{active:!0})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(y,{setIsWorkSubmission:H,isWorkSubmission:A,work:z.WorkSubmission}),(0,i.jsx)(k,{setIsSubmitWork:Y,isSubmitWork:O,ticketId:z.id}),(0,i.jsxs)("div",{className:"tickets-info",children:[(0,i.jsx)("header",{className:"flex flex-row justify-between",children:(0,i.jsxs)("div",{className:"flex flex-col w-full",children:[(0,i.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center w-full",children:[(0,i.jsxs)("div",{className:"flex flex-row items-center opacity-75",children:[(0,i.jsx)("div",{className:"w-6",children:(0,i.jsx)(u.ybL,{size:28})}),(0,i.jsx)("h1",{className:"text-xl md:text-3xl font-semibold ml-2",children:z.title})]}),(null==L?void 0:L.user.id)==z.ownerId||(null==L?void 0:L.user.id)==z.assigneeId?(0,i.jsx)("div",{className:"md:m-0 m-4",children:(0,i.jsx)(n.Z,{defaultValue:function(){var e=W.find(function(e){return e.id==z.ticketStatusId});return null==e?void 0:e.title},style:{width:200},onChange:function(e){return m(e)},children:W.map(function(e){return(0,i.jsx)(n.Z.Option,{value:e.id,children:e.title},e.id)})})}):(0,i.jsx)(i.Fragment,{})]}),(0,i.jsxs)("div",{className:"text-lg flex flex-row items-center",children:[(t=z.TicketStatus.title,(0,i.jsx)("div",{className:"rounded-full text-lg bg-opacity-25",children:(0,i.jsx)("h1",{style:{color:"orange"},children:t})})),(0,i.jsxs)("p",{className:"ml-2",children:[z.user.employee.first_name," ",z.user.employee.last_name]}),(0,i.jsxs)("p",{className:"opacity-50 ml-2",children:["Opened on"," ",f()(z.createdAt).format("MMMM Do YYYY")]})]})]})}),(0,i.jsx)("div",{className:"tabdevider h-[1.5px] my-4 bg-opacity-10 bg-white w-full rounded-lg"}),(0,i.jsx)("div",{className:"border-2 border-gray-600 rounded-lg p-4 h-full",children:(0,i.jsxs)("div",{className:"h-[20rem]",children:[(0,i.jsx)("p",{className:"italic mb-4 font-bold opacity-30",children:"Description"}),(0,i.jsx)("div",{children:z.description})]})}),(0,i.jsx)("div",{className:"tabdevider h-[1.5px] my-4 bg-opacity-10 bg-white w-full rounded-lg"}),(0,i.jsxs)("div",{className:"flex flex-col md:flex-row justify-between w-full h-full",children:[(0,i.jsxs)("div",{className:"flex flex-col w-full md:w-1/2",children:[(0,i.jsxs)("div",{className:"flex justify-between w-full text-base mb-4",children:[(0,i.jsx)("h1",{className:"opacity-50",children:"Assigned to"}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(j.RrS,{size:22,className:"mr-2"}),(0,i.jsxs)("h1",{className:"",children:[z.employee.first_name," ",z.employee.last_name]})]})]}),(0,i.jsxs)("div",{className:"flex justify-between w-full text-base mb-4",children:[(0,i.jsx)("h1",{className:"opacity-50",children:"Project"}),(0,i.jsx)("h1",{className:"",children:z.project.project_name})]}),(0,i.jsxs)("div",{className:"flex justify-between w-full text-base mb-4",children:[(0,i.jsx)("h1",{className:"opacity-50",children:"Team"}),(0,i.jsx)("h1",{className:"",children:z.team.team_name})]}),(0,i.jsxs)("div",{className:"flex justify-between w-full text-base mb-4",children:[(0,i.jsx)("h1",{className:"opacity-50",children:"Deadline"}),(0,i.jsx)("h1",{className:"",children:f()(z.deadline).format("MMMM Do YYYY")})]}),(0,i.jsxs)("div",{className:"flex justify-between w-full text-base mb-4",children:[(0,i.jsx)("h1",{className:"opacity-50",children:"Piority"}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(x.wQ2,{className:"mr-2"}),(0,i.jsx)("h1",{className:"",children:z.TicketPiority.title})]})]})]}),(0,i.jsx)("div",{className:"tabdevider w-[1.5px] md:flex hidden h-[10rem] mx-4 bg-opacity-10 bg-white rounded-lg"}),(0,i.jsxs)("div",{className:"w-full md:w-1/2 flex flex-col",children:[(null==L?void 0:L.user.id)==z.ownerId||(null==L?void 0:L.user.id)==z.assigneeId?(0,i.jsxs)("button",{className:"py-3 mb-2 bg-white bg-opacity-10 transition-all w-full rounded-md flex flex-row justify-center items-center disabled:opacity-50",onClick:function(){return Y(!0)},children:[(0,i.jsx)(b.Oe$,{color:"white",size:20}),(0,i.jsx)("p",{className:"text-white-600 tex-xl font-bold ml-2",children:"Submit Work"})]}):(0,i.jsx)(i.Fragment,{}),(0,i.jsxs)("button",{className:"py-3 mb-2 bg-white bg-opacity-10 transition-all w-full rounded-md flex flex-row justify-center items-center disabled:opacity-50",onClick:function(){return H(!0)},children:[(0,i.jsx)(p.y9N,{color:"white",size:20}),(0,i.jsx)("p",{className:"text-white-600 tex-xl font-bold ml-2",children:"Work Submissions"})]}),z.Resource[0].url?(0,i.jsxs)("button",{className:"py-3 mb-2 bg-green-600 bg-opacity-20 hover:bg-opacity-30 transition-all w-full rounded-md flex flex-row justify-center items-center disabled:opacity-50",onClick:function(){return N(z.Resource[0].url)},disabled:T,children:[(0,i.jsx)(p.eHD,{color:"green",size:20}),(0,i.jsx)("p",{className:"text-green-600 tex-xl font-bold ml-2",children:"Downlaod Resource"})]}):(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"py-3 mb-2 bg-white bg-opacity-10 transition-all w-full rounded-md flex flex-row justify-center items-center disabled:opacity-50",children:[(0,i.jsx)(p.eHD,{color:"white",size:20}),(0,i.jsx)("p",{className:"text-white-600 tex-xl font-bold ml-2",children:"No resource added"})]})}),(0,i.jsx)(w.Z,{grantPermissionFor:"manage_tickets",children:(0,i.jsx)(a.Z,{title:"Are you sure you want to delete this ticket?",onConfirm:function(){v()},okText:"Confirm",cancelText:"No",placement:"top",children:(0,i.jsxs)("button",{className:"py-3 bg-red-600 bg-opacity-20 hover:bg-opacity-30 transition-all w-full rounded-md flex flex-row justify-center items-center",children:[(0,i.jsx)(h.Ybf,{color:"red",size:20}),(0,i.jsx)("p",{className:"text-red-600 tex-xl font-bold ml-2",children:"Delete Ticket"})]})})})]})]})]})]})})}}}]);